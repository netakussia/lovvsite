# Деплой на Render

## Быстрый старт

1. **Создайте аккаунт на [Render.com](https://render.com)**

2. **Подключите репозиторий:**
   - В Dashboard Render нажмите "New" → "Web Service"
   - Подключите ваш Git репозиторий (GitHub/GitLab/Bitbucket)

3. **Настройки деплоя:**
   - **Environment:** Node
   - **Build Command:** `npm install`
   - **Start Command:** `npm start` (или используйте `render.yaml`)
   - **Plan:** Free (или выберите нужный)

4. **Переменные окружения (Environment Variables):**
   ```
   NODE_ENV=production
   JWT_SECRET=your-super-secret-jwt-key-сгенерируйте-свой-уникальный-ключ
   PORT=10000 (Render автоматически установит, но можно задать явно)
   ```

5. **Важные замечания:**
   - База данных SQLite будет создана автоматически при первом запуске
   - Файл `database-schema.sql` используется для инициализации схемы БД
   - На Render Free плане приложение "засыпает" после 15 минут бездействия
   - Для постоянной работы нужен Paid план

## После деплоя

1. Откройте ваш сайт на Render
2. Перейдите на `/platform-admin` для создания первого аккаунта
3. Создайте первый сайт через платформу
4. Доступ к админ-панели сайта: `/admin` (для конкретного сайта)

## Структура проекта

- `server-multitenant.js` - основной сервер (мультитенантная версия)
- `render.yaml` - конфигурация для автоматического деплоя через Render Dashboard
- `Procfile` - используется для определения команды запуска
- `package.json` - зависимости и скрипты

## Проблемы и решения

**Проблема:** База данных не создается
- **Решение:** Убедитесь, что файл `database-schema.sql` находится в корне проекта

**Проблема:** Приложение не запускается
- **Решение:** Проверьте логи в Render Dashboard → Logs
- Убедитесь, что PORT берется из переменной окружения: `process.env.PORT || 3000`

**Проблема:** Статические файлы не загружаются
- **Решение:** Проверьте, что путь к статическим файлам правильный в `server-multitenant.js`

## Альтернативный деплой через render.yaml

Если вы используете Render Blueprint (render.yaml), просто:
1. Нажмите "New" → "Blueprint"
2. Подключите репозиторий
3. Render автоматически создаст сервис по конфигурации из `render.yaml`

